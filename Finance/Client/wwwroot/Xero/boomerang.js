!function(e){var t,n,r,i=e.document;if("undefined"==typeof BOOMR&&(BOOMR={}),!BOOMR.version){BOOMR.version="0.9",t={beacon_url:"",site_domain:e.location.hostname.replace(/.*?([^.]+\.[^.]+)\.?$/,"$1").toLowerCase(),user_ip:"",events:{page_ready:[],page_unload:[],visibility_changed:[],before_beacon:[]},vars:{},disabled_plugins:{},fireEvent:function(e,t){var n,r,i;if(!this.events.hasOwnProperty(e))return!1;for(i=this.events[e],n=0;n<i.length;n++)r=i[n],r[0].call(r[2],t,r[1]);return!0},addListener:function(e,t,n,r){e.addEventListener?e.addEventListener(t,n,r):e.attachEvent&&e.attachEvent("on"+t,n)}},n={utils:{getCookie:function(e){if(!e)return null;e=" "+e+"=";var t,n;return n=" "+i.cookie+";",(t=n.indexOf(e))>=0?(t+=e.length,n=n.substring(t,n.indexOf(";",t))):null},setCookie:function(e,n,r,o,s,a){var u,d,l,p="",f="";if(!e)return!1;for(u in n)n.hasOwnProperty(u)&&(p+="&"+encodeURIComponent(u)+"="+encodeURIComponent(n[u]));return p=p.replace(/^&/,""),r&&(f=new Date,f.setTime(f.getTime()+1e3*r),f=f.toGMTString()),d=e+"="+p,l=d+(r?"; expires="+f:"")+(o?"; path="+o:"")+("undefined"!=typeof s?"; domain="+(null!==s?s:t.site_domain):"")+(a?"; secure":""),d.length<4e3?(i.cookie=l,p===this.getCookie(e)):!1},getSubCookies:function(e){var t,n,r,i,o={};if(!e)return null;if(t=e.split("&"),0===t.length)return null;for(n=0,r=t.length;r>n;n++)i=t[n].split("="),i.push(""),o[decodeURIComponent(i[0])]=decodeURIComponent(i[1]);return o},removeCookie:function(e){return this.setCookie(e,{},0,"/",null)},pluginConfig:function(e,t,n,r){var i,o=0;if(!t||!t[n])return!1;for(i=0;i<r.length;i++)"undefined"!=typeof t[n][r[i]]&&(e[r[i]]=t[n][r[i]],o++);return o>0}},init:function(n){var r,o,s=["beacon_url","site_domain","user_ip"];for(n||(n={}),r=0;r<s.length;r++)"undefined"!=typeof n[s[r]]&&(t[s[r]]=n[s[r]]);"undefined"!=typeof n.log&&(this.log=n.log),this.log||(this.log=function(){});for(o in this.plugins)n[o]&&"undefined"!=typeof n[o].enabled&&n[o].enabled===!1?t.disabled_plugins[o]=1:(t.disabled_plugins[o]&&delete t.disabled_plugins[o],this.plugins.hasOwnProperty(o)&&"function"==typeof this.plugins[o].init&&this.plugins[o].init(n));return("undefined"==typeof n.autorun||n.autorun!==!1)&&t.addListener(e,"load",function(){t.fireEvent("page_ready")}),t.addListener(i,"webkitvisibilitychange",function(){t.fireEvent("visibility_changed")}),t.addListener(e,"unload",function(){e=null}),this},page_ready:function(){return t.fireEvent("page_ready"),this},subscribe:function(n,r,i,o){var s,a,u;if(!t.events.hasOwnProperty(n))return this;for(u=t.events[n],s=0;s<u.length;s++)if(a=u[s],a[0]===r&&a[1]===i&&a[2]===o)return this;return u.push([r,i||{},o||null]),"page_unload"===n&&(t.addListener(e,"unload",function(){r&&r.call(o,null,i),r=o=i=null}),t.addListener(e,"beforeunload",function(){r&&r.call(o,null,i),r=o=i=null})),this},addVar:function(e,n){if("string"==typeof e)t.vars[e]=n;else if("object"==typeof e){var r,i=e;for(r in i)i.hasOwnProperty(r)&&(t.vars[r]=i[r])}return this},removeVar:function(){var e,n;if(!arguments.length)return this;for(n=1===arguments.length&&"[object Array]"===Object.prototype.toString.apply(arguments[0])?arguments[0]:arguments,e=0;e<n.length;e++)t.vars.hasOwnProperty(n[e])&&delete t.vars[n[e]];return this},sendBeacon:function(){var e,n,r,o=0;for(e in this.plugins)if(this.plugins.hasOwnProperty(e)){if(t.disabled_plugins[e])continue;if(!this.plugins[e].is_complete())return this}if(t.fireEvent("before_beacon",t.vars),!t.beacon_url)return this;n=t.beacon_url+"&v="+encodeURIComponent(BOOMR.version)+"&u="+encodeURIComponent(i.URL.replace(/#.*/,""));for(e in t.vars)t.vars.hasOwnProperty(e)&&(o++,n+="&"+encodeURIComponent(e)+"="+encodeURIComponent(t.vars[e]));return o&&(r=new Image,r.src=n),this}};var o=function(e){return function(t,n){return this.log(t,e,"boomerang"+(n?"."+n:"")),this}};n.debug=o("debug"),n.info=o("info"),n.warn=o("warn"),n.error=o("error"),e.YAHOO&&e.YAHOO.widget&&e.YAHOO.widget.Logger?n.log=e.YAHOO.log:"undefined"!=typeof e.Y&&"undefined"!=typeof e.Y.log?n.log=e.Y.log:"undefined"!=typeof console&&"undefined"!=typeof console.log&&(n.log=function(e,t,n){console.log(n+": ["+t+"] ",e)});for(r in n)n.hasOwnProperty(r)&&(BOOMR[r]=n[r]);BOOMR.plugins=BOOMR.plugins||{}}}(window),function(e){var t=e.document;BOOMR=BOOMR||{},BOOMR.plugins=BOOMR.plugins||{};var n={complete:!1,timers:{},cookie:"RT",cookie_exp:600,strict_referrer:!0,navigationStart:void 0,responseStart:void 0,start:function(){var e,n=(new Date).getTime();return this.cookie?BOOMR.utils.setCookie(this.cookie,{s:n,r:t.URL.replace(/#.*/,"")},this.cookie_exp,"/",null)?(e=(new Date).getTime(),e-n>50&&(BOOMR.utils.removeCookie(this.cookie),BOOMR.error("took more than 50ms to set cookie... aborting: "+n+" -> "+e,"rt")),this):(BOOMR.error("cannot set start cookie","rt"),this):this},initNavTiming:function(){var t,n;this.navigationStart||(n=e.performance||e.msPerformance||e.webkitPerformance||e.mozPerformance,n&&n.timing?t=n.timing:e.chrome&&e.chrome.csi?(t={navigationStart:e.chrome.csi().startE,responseStart:void 0},BOOMR.addVar("rt.start","csi")):e.gtbExternal&&(t={navigationStart:e.gtbExternal.startE(),responseStart:void 0},BOOMR.addVar("rt.start","gtb")),t?(BOOMR.addVar("rt.start","navigation"),this.navigationStart=t.navigationStart||void 0,this.responseStart=t.responseStart||void 0):BOOMR.warn("This browser doesn't support the WebTiming API","rt"))}};BOOMR.plugins.RT={init:function(e){return n.complete=!1,n.timers={},BOOMR.utils.pluginConfig(n,e,"RT",["cookie","cookie_exp","strict_referrer"]),BOOMR.subscribe("page_ready",this.done,null,this),BOOMR.subscribe("page_unload",n.start,null,n),this},startTimer:function(e,t){return e&&("t_page"===e&&this.endTimer("t_resp",t),n.timers[e]={start:"number"==typeof t?t:(new Date).getTime()},n.complete=!1),this},endTimer:function(e,t){return e&&(n.timers[e]=n.timers[e]||{},"undefined"==typeof n.timers[e].end&&(n.timers[e].end="number"==typeof t?t:(new Date).getTime())),this},setTimer:function(e,t){return e&&(n.timers[e]={delta:t}),this},done:function(){var e,r,i,o,s,a,u={t_done:1,t_resp:1,t_page:1},d=0,l=[];if(n.complete)return this;if(n.initNavTiming(),document.webkitVisibilityState&&"prerender"===document.webkitVisibilityState)return this.startTimer("t_load",n.navigationStart),this.endTimer("t_load"),this.startTimer("t_prerender",n.navigationStart),this.startTimer("t_postrender"),BOOMR.subscribe("visibility_changed",this.done,null,this),this;this.endTimer("t_done"),n.responseStart?(this.setTimer("t_resp",n.responseStart-n.navigationStart),n.timers.t_load?this.setTimer("t_page",n.timers.t_load.end-n.responseStart):this.setTimer("t_page",(new Date).getTime()-n.responseStart)):n.timers.hasOwnProperty("t_page")&&this.endTimer("t_page"),n.timers.hasOwnProperty("t_postrender")&&(this.endTimer("t_postrender"),this.endTimer("t_prerender")),r=i=t.referrer.replace(/#.*/,""),n.cookie&&(o=BOOMR.utils.getSubCookies(BOOMR.utils.getCookie(n.cookie)),BOOMR.utils.removeCookie(n.cookie),null!==o&&"undefined"!=typeof o.s&&"undefined"!=typeof o.r&&(r=o.r,n.strict_referrer&&r!==i||(e=parseInt(o.s,10)))),e?BOOMR.addVar("rt.start","cookie"):e=n.navigationStart,BOOMR.removeVar("t_done","t_page","t_resp","r","r2");for(s in n.timers)n.timers.hasOwnProperty(s)&&(a=n.timers[s],"number"!=typeof a.delta&&("number"!=typeof a.start&&(a.start=e),a.delta=a.end-a.start),isNaN(a.delta)||(u.hasOwnProperty(s)?BOOMR.addVar(s,a.delta):l.push(s+"|"+a.delta),d++));return d&&(BOOMR.addVar("r",r),i!==r&&BOOMR.addVar("r2",i),l.length&&BOOMR.addVar("t_other",l.join(","))),n.timers={},n.complete=!0,BOOMR.sendBeacon(),this},is_complete:function(){return n.complete}}}(window);
