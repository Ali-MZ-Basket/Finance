!function(i){function n(t){if(e[t])return e[t].exports;var o=e[t]={i:t,l:!1,exports:{}};return i[t].call(o.exports,o,o.exports,n),o.l=!0,o.exports}var e={};n.m=i,n.c=e,n.d=function(i,e,t){n.o(i,e)||Object.defineProperty(i,e,{configurable:!1,enumerable:!0,get:t})},n.n=function(i){var e=i&&i.__esModule?function(){return i.default}:function(){return i};return n.d(e,"a",e),e},n.o=function(i,n){return Object.prototype.hasOwnProperty.call(i,n)},n.p="/assets/",n(n.s=295)}({295:function(i,n){window.InvoicePrinting={},window.analyticEvents={printPDF:function(i){window.Invoice.invoiceTypeCode||window.Invoice.invoiceTypeCode;switch(window.Invoice.invoiceData?window.Invoice.IsNew?"CREATE":"EDIT":"VIEW"){case"CREATE":case"EDIT":window.Invoice.invoiceData.Invoice.InvoiceStatusCode;break;case"VIEW":window.Invoice.InvoiceStatusCode}if(window.ga){var n={hitType:"event",eventCategory:"Send and Approve Invoice",eventAction:"Print",eventLabel:"Print from classic Invoicing"};window.ga("send",n)}}},Object.extend(InvoicePrinting,{pleaseWaitWindow:null,documentType:null,invoicePrintJobId:0,invoicePrintPollCounter:0,DOCUMENTTYPES:{INVOICE:"Invoice",STATEMENT:"Statement",PAYSLIP:"Payslip",PAYMENTADVICE:"Receipt",REMITTANCE:"Remittance",BATCHDEPOSIT:"Deposit Summary",BATCHPAYMENT:"Batch Payment Summary",CHEQUE:XERO.lang.Words.ChequeTitle},PrintInvoicesFromForm:function(i,n,e){if(e||(e=InvoicePrinting.DOCUMENTTYPES.INVOICE),InvoicePrinting.invoicePrintPollCounter=0,0==InvoicePrinting.invoicePrintJobId){for(var t=[],o=document.getElementsByName(i),r=o.length,c=0;c<r;c++){var a=o[c];a&&(a.checked&&t.push(a.value))}InvoicePrinting.ShowPleaseWaitScreen(e,t.length),Ajax.PrintInvoices(t,n,InvoicePrinting.StartInvoicePrintJob_Callback)}else InvoicePrinting.pollingId=window.setTimeout(InvoicePrinting.GetInvoicePrintStatusJob,2e3)},PrintPayslipsFromForm:function(i,n,e){if(InvoicePrinting.invoicePrintPollCounter=0,0==InvoicePrinting.invoicePrintJobId){for(var t=[],o=document.getElementsByName(i),r=o.length,c=0;c<r;c++){var a=o[c];a&&(a.checked&&t.push(a.value))}InvoicePrinting.ShowPleaseWaitScreen(InvoicePrinting.DOCUMENTTYPES.PAYSLIP,t.length),Ajax.PrintPayslips(t,n,e,InvoicePrinting.StartInvoicePrintJob_Callback)}else InvoicePrinting.pollingId=window.setTimeout(InvoicePrinting.GetInvoicePrintStatusJob,2e3)},PrintChequesFromForm:function(i){if(InvoicePrinting.invoicePrintPollCounter=0,0==InvoicePrinting.invoicePrintJobId){for(var n=[],e=document.getElementsByName(i),t=e.length,o=0;o<t;o++){var r=Ext.get(e[o]);r&&(r.dom.checked&&r.hasClass("Uncleared")&&n.push(r.getValue()))}InvoicePrinting.ShowPleaseWaitScreen(InvoicePrinting.DOCUMENTTYPES.CHEQUE,n.length),Ajax.PrintCheques(n,InvoicePrinting.StartInvoicePrintJob_Callback)}else InvoicePrinting.pollingId=window.setTimeout(InvoicePrinting.GetInvoicePrintStatusJob,2e3)},PrintSingleInvoiceWithMarkPrompt:function(i,n,e){e||(e="Invoice"),1==n||"True"==n||"true"==n?InvoicePrinting.PrintSingleInvoice(i,!1,e):XERO.MsgBox.confirmMarkAsSent("Confirm","Would you like to mark this "+e.toLowerCase()+" as sent?","Mark as sent",'XERO.util.enableButtons();InvoicePrinting.PrintSingleInvoice("'+i+'", true, "'+e+'")',"Leave as-is",'XERO.util.enableButtons();InvoicePrinting.PrintSingleInvoice("'+i+'", false, "'+e+'")')},PrintSingleInvoice:function(i,n,e){return e&&e!=InvoicePrinting.DOCUMENTTYPES.INVOICE||!window.Invoice||!window.Invoice.invoiceTypeCode&&!window.Invoice.InvoiceTypeCode||analyticEvents.printPDF(n),InvoicePrinting.invoicePrintPollCounter=0,InvoicePrinting.ShowPleaseWaitScreen(e&&e!=InvoicePrinting.DOCUMENTTYPES.INVOICE?e:InvoicePrinting.DOCUMENTTYPES.INVOICE,1),0==InvoicePrinting.invoicePrintJobId?(Ajax.PrintInvoice(i,n,InvoicePrinting.StartInvoicePrintJob_Callback),n&&(XERO.Invoices.cache.get(0).mark(),Ext.select("div.status div.middle div.markAsSent").show(),Ext.select("div.status div.left span").show())):window.setTimeout(InvoicePrinting.GetInvoicePrintStatusJob,2e3),!1},PrintSingleStatement:function(i,n,e,t,o){return InvoicePrinting.invoicePrintPollCounter=0,InvoicePrinting.ShowPleaseWaitScreen(InvoicePrinting.DOCUMENTTYPES.STATEMENT,Ext.isArray(i)?i.length:1),0==InvoicePrinting.invoicePrintJobId?(null==o&&(o=""),Ajax.StartStatementPrintJob(Ext.isArray(i)?i:new Array(i),n,e,t,o,InvoicePrinting.StartInvoicePrintJob_Callback)):window.setTimeout(InvoicePrinting.GetInvoicePrintStatusJob,2e3),!1},PrintSinglePaymentAdvice:function(i,n,e){return InvoicePrinting.invoicePrintPollCounter=0,InvoicePrinting.ShowPleaseWaitScreen(InvoicePrinting.DOCUMENTTYPES.PAYMENTADVICE,1),0==InvoicePrinting.invoicePrintJobId?(null==i&&(i=""),Ajax.StartPaymentAdvicePrintJob(i,n,e,InvoicePrinting.StartInvoicePrintJob_Callback)):window.setTimeout(InvoicePrinting.GetInvoicePrintStatusJob,2e3),!1},PrintBatchPaymentAdvice:function(i,n,e,t,o){return InvoicePrinting.invoicePrintPollCounter=0,InvoicePrinting.ShowPleaseWaitScreen(o?InvoicePrinting.DOCUMENTTYPES.BATCHPAYMENT:InvoicePrinting.DOCUMENTTYPES.BATCHDEPOSIT,1),0==InvoicePrinting.invoicePrintJobId?(null==i&&(i=""),Ajax.StartPaymentAdviceBatchPrintJob(n,e,t,o,InvoicePrinting.StartInvoicePrintJob_Callback)):window.setTimeout(InvoicePrinting.GetInvoicePrintStatusJob,2e3),!1},PrintDocument:function(i,n,e){var n=n||1,t=Ext.get("TemplateDropDown").getValue();return InvoicePrinting.invoicePrintPollCounter=0,InvoicePrinting.ShowPleaseWaitScreen(i,n),0==InvoicePrinting.invoicePrintJobId?(null==t&&(t=""),e(t)):window.setTimeout(InvoicePrinting.GetInvoicePrintStatusJob,2e3),!1},ShowTemplateChooserDialog:function(i,n,e){var t=XERO.MsgBox.createAjax(e.toLowerCase(),{modal:!0,title:"View "+e,width:350,height:165});Ajax.PrintDocumentPopupHtml(i,n,e,function(i){var n=i.value;t.setHtml(n.Result),XERO.widget.Buttons&&XERO.widget.Buttons.enable()})},PrintSinglePayslipWithMarkPrompt:function(i,n,e){!XERO.Invoices.cache.get(0).sent||1!=e&&"True"!=e&&"true"!=e?XERO.MsgBox.confirmMarkAsSent("Confirm","Would you like to mark this payslip as sent?","Mark as sent",'XERO.util.enableButtons();InvoicePrinting.PrintSinglePayslip("'+i+'","'+n+'",true)',"Leave as-is",'XERO.util.enableButtons();InvoicePrinting.PrintSinglePayslip("'+i+'","'+n+'",false)'):InvoicePrinting.PrintSinglePayslip(i,n,!1)},PrintSinglePayslip:function(i,n,e){return InvoicePrinting.invoicePrintPollCounter=0,InvoicePrinting.ShowPleaseWaitScreen(InvoicePrinting.DOCUMENTTYPES.PAYSLIP,Ext.isArray(i)?i.length:1),0==InvoicePrinting.invoicePrintJobId?(Ajax.PrintPayslip(i,n,e,InvoicePrinting.StartInvoicePrintJob_Callback),e&&XERO.Invoices.cache.get(0).mark()):window.setTimeout(InvoicePrinting.GetInvoicePrintStatusJob,2e3),!1},PrintSingleCheque:function(i){return InvoicePrinting.invoicePrintPollCounter=0,InvoicePrinting.ShowPleaseWaitScreen(InvoicePrinting.DOCUMENTTYPES.CHEQUE,Ext.isArray(i)?i.length:1),0==InvoicePrinting.invoicePrintJobId?Ajax.PrintCheque(i,InvoicePrinting.StartInvoicePrintJob_Callback):window.setTimeout(InvoicePrinting.GetInvoicePrintStatusJob,2e3),!1},StartInvoicePrintJob_Callback:function(i){var n=i.value;if(!n)return void XERO.MsgBox.alert("Sorry, an error occurred. Please contact Xero Support if you require assistance.","Error");if(-1==n.Result||-2==n.Result)return void XERO.MsgBox.alert("Sorry, an error occurred. Please contact Xero Support if you require assistance.","Error");var e=n.Data.getValue("invoiceMarkAsSent"),t=0;if(e)for(t=0;t<e.length;t++)Ext.fly("sent_"+e[t]).removeClass("hide").addClass("show");return InvoicePrinting.invoicePrintJobId=n.Result,window.setTimeout(InvoicePrinting.GetInvoicePrintStatusJob,2e3),!1},ShowPleaseWaitScreen:function(i,n){Ext.WindowMgr.getActive()&&Ext.WindowMgr.getActive().close(),InvoicePrinting.documentType=i,InvoicePrinting.pleaseWaitWindow=new XERO.widget.FilePendingPopup({fileType:i,filesPending:n}),InvoicePrinting.pleaseWaitWindow.show().center()},SetShowPleaseWaitScreen:function(i,n,e,t){InvoicePrinting.ShowPleaseWaitScreen(i,n),InvoicePrinting.invoicePrintJobId=e,InvoicePrinting.invoicePrintPollCounter=0,window.setTimeout(t,2e3)},GetInvoicePrintStatusJob:function(){if(InvoicePrinting.invoicePrintPollCounter=InvoicePrinting.invoicePrintPollCounter+1,0==InvoicePrinting.invoicePrintJobId)return void(InvoicePrinting.invoicePrintPollCounter=0);InvoicePrinting.invoicePrintPollCounter>=60?(Windows.closeAll(),XERO.MsgBox.alert("Sorry, an error occurred. Please contact Xero Support if you require assistance.","Error")):Ajax.GetPrintJobStatus(InvoicePrinting.invoicePrintJobId,InvoicePrinting.GetPrintStatusJob_Callback)},GetPrintStatusJob_Callback:function(i){var n=i.value;if(0!=InvoicePrinting.invoicePrintJobId){if(!n)return void InvoicePrinting.pleaseWaitWindow.setHtml("<div>I'm sorry, the document cannot be printed at the moment. Please contact Xero Support if you require assistance.</div><div>"+i.error.Message+"</div>");if("JOBSTATUS/COMPLETED"==n.Result){var e=n.Data.getValue("RedirectURL");null!=e&&""!=e?(XERO.widget.Buttons.enable(),e=InvoicePrinting.FormatUrl(e)):e=InvoicePrinting.GetRedirectUrl(),InvoicePrinting.invoicePrintJobId=0,InvoicePrinting.invoicePrintPollCounter=0,window.location.href=e;var t=Ext.WindowMgr.getActive();t&&t.close()}else"JOBSTATUS/QUEUED"==n.Result||"JOBSTATUS/ACTIVE"==n.Result?window.setTimeout(InvoicePrinting.GetInvoicePrintStatusJob,2e3):"JOBSTATUS/FAILED"==n.Result?InvoicePrinting.pleaseWaitWindow.showFailed():"JOBSTATUS/MISMATCHINGPLACEHOLDERS"!=n.Result&&"JOBSTATUS/GENERICDOCXERROR"!=n.Result||InvoicePrinting.pleaseWaitWindow.showFailed("Oh dear! It looks like your custom invoice template is missing crucial information which will prevent it from being printed. You need to fix it before printing the invoice. <a href='https://help.xero.com/InvoiceBrandingTableFields' target='_blank'>Learn more here in Xero Help</a>.");return!1}},GetRedirectUrl:function(){var i;switch(InvoicePrinting.documentType){case InvoicePrinting.DOCUMENTTYPES.CHEQUE:i="cheque";break;case InvoicePrinting.DOCUMENTTYPES.PAYMENTADVICE:case InvoicePrinting.DOCUMENTTYPES.REMITTANCE:case InvoicePrinting.DOCUMENTTYPES.BATCHDEPOSIT:case InvoicePrinting.DOCUMENTTYPES.BATCHPAYMENT:i="accountsReceivable";break;default:i="standard"}var n={};return n.cheque=InvoicePrinting.FormatUrl("/Checks/CheckDownloader.aspx?PrintJobId="),n.accountsReceivable=InvoicePrinting.FormatUrl("/AccountsReceivable/InvoiceDownloader.aspx?PrintJobId="),n.standard=InvoicePrinting.FormatUrl("InvoiceDownloader.aspx?PrintJobId="),n[i]},FormatUrl:function(i){return String.format("{0}{1}",i,InvoicePrinting.invoicePrintJobId)}}),XERO.widget.FilePendingPopup=Ext.extend(Ext.Window,{title:"Print {0}{1}",closable:!1,width:390,height:170,cls:"file-pending",layout:"fit",resizable:!1,fileType:InvoicePrinting.DOCUMENTTYPES.INVOICE,filesPending:0,modal:!0,initComponent:function(){this.title=String.format(this.title,this.fileType,1==this.filesPending?"":"s"),this.descriptionLabel=Ext.create({xtype:"container",cls:"pending-file-description",itemId:"pending-file-description",autoEl:{tag:"span",html:"Preparing to print:  "}}),this.infoLabel=Ext.create({xtype:"container",cls:"pending-file-count",autoEl:{tag:"strong",html:String.format("{0} {1}{2}",this.filesPending,this.fileType.toLowerCase(),1==this.filesPending?"":"s")}}),this.failedLabel=Ext.create({xtype:"container",cls:"pending-file-failed",itemId:"pending-file-failed",hidden:!0,style:{clear:"both"},autoEl:{tag:"div",html:"I'm sorry, the document cannot be printed at the moment. Please try again or contact Xero Support if you require assistance."}}),this.printButton=Ext.create({xtype:"box",autoEl:{tag:"a",cls:"xbtn x-pad large green pending-disabled skip exclude",href:"javascript:",html:"Please wait...</a>"},listeners:{afterrender:function(i){i.addEvents("click"),i.getEl().on("click",function(){i.getEl().hasClass("disabled")||i.fireEvent("click",i)},i,{stopEvent:!0})},scope:this}}),this.items=[new Ext.Panel({items:[this.descriptionLabel,this.infoLabel,this.failedLabel,{xtype:"container",cls:"actions",items:[this.printButton,{xtype:"box",autoEl:{tag:"a",cls:"xbtn large gray exclude skip",href:"javascript:",html:"Cancel"},listeners:{afterrender:function(i){i.addEvents("click"),i.getEl().on("click",function(){i.getEl().hasClass("disabled")||i.fireEvent("click",i)},i,{stopEvent:!0})},click:this.closeAndCancel,scope:this}}]}]})],XERO.widget.FilePendingPopup.superclass.initComponent.call(this)},showFailed:function(i){this.descriptionLabel.hide(),this.printButton.getEl().hide(),this.infoLabel.hide(),i&&(Ext.get(this.failedLabel.id).dom.innerHTML=i),this.failedLabel.show(),this.doLayout(),this.syncSize(),this.syncShadow()},hasBeenClicked:!1,closeAndCancel:function(){this.cancelFile(),this.close(),this.hasBeenClicked=!1},cancelFile:function(){Ajax.CancelPrintJob(InvoicePrinting.invoicePrintJobId),InvoicePrinting.invoicePrintJobId=0,InvoicePrinting.invoicePrintPollCounter=0}})}});